<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¡°ì£¼ê¸°ëŠ¥ì‚¬ ì¹µí…Œì¼ ë ˆì‹œí”¼ í€´ì¦ˆ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- ì‹œì‘ í™”ë©´ -->
        <div v-if="currentScreen === 'start'" class="screen start-screen">
            <div class="container">
                <div class="header">
                    <h1>ğŸ¹ ì¡°ì£¼ê¸°ëŠ¥ì‚¬ ì¹µí…Œì¼ ë ˆì‹œí”¼ í€´ì¦ˆ</h1>
                    <p class="subtitle">40ê°€ì§€ ì¹µí…Œì¼ ì™„ë²½ ì •ë³µ!</p>
                </div>

                <div class="mode-selector">
                    <h2>í•™ìŠµ ëª¨ë“œ ì„ íƒ</h2>
                    
                    <!-- ì „ì²´ í•™ìŠµ -->
                    <div class="mode-card" @click="startQuiz('all', 40)">
                        <div class="mode-icon">ğŸ“š</div>
                        <div class="mode-content">
                            <h3>ì „ì²´ í•™ìŠµ</h3>
                            <p>40ê°œ ì¹µí…Œì¼ ëª¨ë‘</p>
                        </div>
                    </div>

                    <!-- ì¹´í…Œê³ ë¦¬ë³„ í•™ìŠµ -->
                    <div class="mode-card" @click="showCategorySelection = true">
                        <div class="mode-icon">ğŸ·ï¸</div>
                        <div class="mode-content">
                            <h3>ë² ì´ìŠ¤ë³„ í•™ìŠµ</h3>
                            <p>ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>

                    <!-- ëœë¤ í€´ì¦ˆ -->
                    <div class="mode-card" @click="startQuiz('all', 10)">
                        <div class="mode-icon">ğŸ²</div>
                        <div class="mode-content">
                            <h3>ëœë¤ 10ë¬¸ì œ</h3>
                            <p>ë¹ ë¥¸ í•™ìŠµ</p>
                        </div>
                    </div>

                    <div class="mode-card" @click="startQuiz('all', 20)">
                        <div class="mode-icon">ğŸ°</div>
                        <div class="mode-content">
                            <h3>ëœë¤ 20ë¬¸ì œ</h3>
                            <p>ì‹¬í™” í•™ìŠµ</p>
                        </div>
                    </div>

                    <!-- í”Œë˜ì‹œì¹´ë“œ ëª¨ë“œ -->
                    <div class="mode-card" @click="startFlashcard()">
                        <div class="mode-icon">ğŸ´</div>
                        <div class="mode-content">
                            <h3>í”Œë˜ì‹œì¹´ë“œ</h3>
                            <p>ì•”ê¸° í•™ìŠµ</p>
                        </div>
                    </div>

                    <!-- ì˜¤ë‹µë…¸íŠ¸ -->
                    <div class="mode-card" v-if="wrongAnswers.length > 0" @click="startQuizFromWrong()">
                        <div class="mode-icon">âŒ</div>
                        <div class="mode-content">
                            <h3>ì˜¤ë‹µë…¸íŠ¸</h3>
                            <p>{{wrongAnswers.length}}ê°œ ë¬¸ì œ</p>
                        </div>
                    </div>
                </div>

                <!-- í†µê³„ ì •ë³´ -->
                <div v-if="stats.totalAttempts > 0" class="stats">
                    <h3>ğŸ“Š í•™ìŠµ í†µê³„</h3>
                    <div class="stat-info">
                        <div class="stat-item">
                            <span class="stat-label">ì´ ì‹œë„</span>
                            <span class="stat-value">{{stats.totalAttempts}}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">í‰ê·  ì ìˆ˜</span>
                            <span class="stat-value">{{(stats.averageScore * 100).toFixed(0)}}%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ìµœê³  ì ìˆ˜</span>
                            <span class="stat-value">{{(stats.maxScore * 100).toFixed(0)}}%</span>
                        </div>
                    </div>
                    <button @click="resetStats" class="btn-reset">í†µê³„ ì´ˆê¸°í™”</button>
                </div>
            </div>
        </div>

        <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ í™”ë©´ -->
        <div v-if="showCategorySelection" class="screen modal-overlay">
            <div class="modal-content">
                <h2>ë² ì´ìŠ¤ ì„ íƒ</h2>
                <div class="category-grid">
                    <div v-for="category in categories" :key="category" class="category-btn"
                        @click="selectCategory(category)">
                        {{category}}
                    </div>
                </div>
                <button @click="showCategorySelection = false" class="btn-close">ë‹«ê¸°</button>
            </div>
        </div>

        <!-- í€´ì¦ˆ í™”ë©´ -->
        <div v-if="currentScreen === 'quiz'" class="screen quiz-screen">
            <div class="container">
                <!-- ìƒë‹¨ ì •ë³´ -->
                <div class="quiz-header">
                    <div class="progress-info">
                        <span class="question-counter">{{currentQuestionIndex + 1}} / {{quizQuestions.length}}</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" :style="{ width: progressPercentage + '%' }"></div>
                    </div>
                </div>

                <!-- ë¬¸ì œ ì¹´ë“œ -->
                <div class="question-card" v-if="currentQuestion">
                    <div class="question-type">{{currentQuestion.type}}</div>
                    <div class="question-text">{{currentQuestion.question}}</div>
                    
                    <!-- ì„ íƒì§€ -->
                    <div class="options">
                        <button v-for="(option, idx) in currentQuestion.options" 
                                :key="idx"
                                class="option-btn"
                                :class="{
                                    'selected': selectedAnswer === idx,
                                    'correct': showFeedback && idx === currentQuestion.correctIndex,
                                    'incorrect': showFeedback && selectedAnswer === idx && idx !== currentQuestion.correctIndex,
                                    'disabled': showFeedback
                                }"
                                @click="selectAnswer(idx)"
                                :disabled="showFeedback">
                            {{option}}
                        </button>
                    </div>

                    <!-- í”¼ë“œë°± -->
                    <div v-if="showFeedback" class="feedback" :class="{ 'correct': isCorrect, 'incorrect': !isCorrect }">
                        <span v-if="isCorrect">âœ“ ì •ë‹µì…ë‹ˆë‹¤!</span>
                        <span v-else>âœ— í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µ: {{currentQuestion.options[currentQuestion.correctIndex]}}</span>
                    </div>

                    <!-- ë‹¤ìŒ ë²„íŠ¼ -->
                    <div v-if="showFeedback" class="action-buttons">
                        <button @click="nextQuestion" class="btn-primary">
                            {{currentQuestionIndex === quizQuestions.length - 1 ? 'ê²°ê³¼ ë³´ê¸°' : 'ë‹¤ìŒ ë¬¸ì œ'}}
                        </button>
                    </div>
                </div>

                <!-- ë‹µë³€ ì„ íƒ ì „ ì•ˆë‚´ -->
                <div v-if="!showFeedback && selectedAnswer === null" class="hint">
                    ğŸ’¡ 4ê°œì˜ ì„ íƒì§€ ì¤‘ ì •ë‹µì„ ì„ íƒí•˜ì„¸ìš”
                </div>
            </div>
        </div>

        <!-- í”Œë˜ì‹œì¹´ë“œ ëª¨ë“œ -->
        <div v-if="currentScreen === 'flashcard'" class="screen flashcard-screen">
            <div class="container">
                <div class="flashcard-header">
                    <span class="card-counter">{{currentFlashcardIndex + 1}} / {{filteredCocktails.length}}</span>
                    <button @click="exitFlashcard" class="btn-exit">ì¢…ë£Œ</button>
                </div>

                <!-- í”Œë¦½ ì¹´ë“œ -->
                <div class="flashcard-container">
                    <div class="flashcard" :class="{ 'flipped': isFlipped }" @click="toggleFlip">
                        <div class="flashcard-front">
                            <div class="card-label">ğŸ¹</div>
                            <div class="card-name">{{currentFlashcard.name_ko}}</div>
                            <div class="card-hint">(í´ë¦­í•˜ë©´ ë’¤ì§‘í˜€ìš”)</div>
                        </div>
                        <div class="flashcard-back">
                            <div class="recipe-info">
                                <h4>{{currentFlashcard.name_ko}}</h4>
                                <div class="recipe-line">
                                    <strong>ê¸°ì£¼:</strong> {{currentFlashcard.base}}
                                </div>
                                <div class="recipe-line">
                                    <strong>ê¸°ë²•:</strong> {{currentFlashcard.method}}
                                </div>
                                <div class="recipe-line">
                                    <strong>ê¸€ë¼ìŠ¤:</strong> {{currentFlashcard.glass}}
                                </div>
                                <div class="recipe-line">
                                    <strong>ì¬ë£Œ:</strong>
                                    <div class="ingredients-list">
                                        <div v-for="ingredient in currentFlashcard.ingredients" :key="ingredient">
                                            â€¢ {{ingredient}}
                                        </div>
                                    </div>
                                </div>
                                <div class="recipe-line">
                                    <strong>ê°€ë‹ˆì‰¬:</strong> {{currentFlashcard.garnish}}
                                </div>
                                <div v-if="currentFlashcard.tips" class="recipe-line">
                                    <strong>ğŸ’¡ íŒ:</strong> {{currentFlashcard.tips}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
                <div class="flashcard-navigation">
                    <button @click="prevFlashcard" class="btn-secondary">â† ì´ì „</button>
                    <button @click="nextFlashcard" class="btn-secondary">ë‹¤ìŒ â†’</button>
                </div>

                <!-- ë‚œì´ë„ í‰ê°€ -->
                <div class="difficulty-rating">
                    <button @click="rateFlashcard('easy')" class="difficulty-btn easy">âœ“ ì•Œê³  ìˆì–´ìš”</button>
                    <button @click="rateFlashcard('hard')" class="difficulty-btn hard">âœ— ëª¨ë¥´ê² ì–´ìš”</button>
                </div>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div v-if="currentScreen === 'result'" class="screen result-screen">
            <div class="container">
                <div class="result-header">
                    <h2>ê²°ê³¼</h2>
                    <div class="score-box" :class="{ 'excellent': scorePercentage >= 90, 'good': scorePercentage >= 70, 'fair': true }">
                        <div class="score-number">{{scorePercentage.toFixed(0)}}%</div>
                        <div class="score-text">
                            {{scorePercentage >= 90 ? 'í›Œë¥­í•©ë‹ˆë‹¤!' : scorePercentage >= 70 ? 'ì–‘í˜¸í•©ë‹ˆë‹¤!' : 'ë” ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤!'}}
                        </div>
                        <div class="score-detail">{{score}} / {{quizQuestions.length}} ì •ë‹µ</div>
                    </div>
                </div>

                <!-- ì¹´í…Œê³ ë¦¬ë³„ ì„±ì  -->
                <div class="category-performance">
                    <h3>ì¹´í…Œê³ ë¦¬ë³„ ì„±ì </h3>
                    <div v-for="(categoryScore, base) in performanceByBase" :key="base" class="performance-item">
                        <span class="base-name">{{base}}</span>
                        <div class="performance-bar">
                            <div class="performance-fill" :style="{ width: (categoryScore.correct / categoryScore.total * 100) + '%' }"></div>
                        </div>
                        <span class="performance-text">{{categoryScore.correct}}/{{categoryScore.total}}</span>
                    </div>
                </div>

                <!-- ê²°ê³¼ ìƒì„¸ -->
                <div class="result-details">
                    <h3>{{showOnlyWrong ? 'í‹€ë¦° ë¬¸ì œ (' + wrongAnswersDetail.length + 'ê°œ)' : 'ì „ì²´ ê²°ê³¼'}}</h3>
                    
                    <div class="toggle-buttons">
                        <button @click="showOnlyWrong = false" :class="{ 'active': !showOnlyWrong }">ì „ì²´</button>
                        <button @click="showOnlyWrong = true" :class="{ 'active': showOnlyWrong }">ì˜¤ë‹µë§Œ</button>
                    </div>

                    <div class="result-list">
                        <div v-for="(result, idx) in displayedResults" :key="idx" class="result-item" 
                             :class="{ 'correct': result.isCorrect, 'incorrect': !result.isCorrect }">
                            <div class="result-number">{{idx + 1}}</div>
                            <div class="result-content">
                                <div class="result-question">{{result.question}}</div>
                                <div class="result-answer">
                                    <strong>ì‚¬ìš©ì ë‹µ:</strong> {{result.userAnswer}}
                                </div>
                                <div v-if="!result.isCorrect" class="result-correct-answer">
                                    <strong>ì •ë‹µ:</strong> {{result.correctAnswer}}
                                </div>
                            </div>
                            <div class="result-icon">{{result.isCorrect ? 'âœ“' : 'âœ—'}}</div>
                        </div>
                    </div>
                </div>

                <!-- ì•¡ì…˜ ë²„íŠ¼ -->
                <div class="action-buttons">
                    <button @click="retakeQuiz" class="btn-primary">ë‹¤ì‹œ í’€ê¸°</button>
                    <button @click="goHome" class="btn-secondary">ì²˜ìŒìœ¼ë¡œ</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
